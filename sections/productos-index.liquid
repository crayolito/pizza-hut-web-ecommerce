<!-- Hoja de estilos Css -->
{{ 'productos-index.css' | asset_url | stylesheet_tag }}
{{ 'estilos-generales.css' | asset_url | stylesheet_tag }}

<productos-index>
  <div class="pi-base container-base">
    <section class="pi-titulo">
      <small class="pi-titulo-1">tu pizza favorita</small>
      <small class="pi-titulo-2">¡Te espera!</small>
    </section>
    <section class="phpi-general-productos">
      <!-- APARTADO DESKTOP -->
      <div class="phpi-general-mobile">
        <div id="phpi-sector1-mobile" class="container-productos-general">
          <div class="producto-item">
            <div class="producto-item-imagen">
              <img src="{{ 'imagen-pizza-1.png' | asset_url }}" alt="Pizza 1" width="100%" height="100%">
            </div>
            <div
              tipo-producto="simple"
              class="producto-item-detalle"
            >
              <div class="producto-item-info">
                <h3>CHESSY LOVERS</h3>
                <p>
                  Salsa de tomate, queso mozarella, Pepperoni, Jamón, carnes mixtas (res y cerdo, salchicha italiana y
                  tocino.
                </p>
              </div>
              <h3 class="color-letras-primary">12.56 BS</h3>
              <div
                id="phpi-general-variantes"
                tipo-producto="simple"
                class="seleccion-variante-producto-general"
              >
                <p>Tamaño</p>
                <button id="phpi-view-variantes" class="container-info-variante">
                  <p id="phpi-variante-seleccionado">Personal</p>
                  <div class="icono-dropdown-variantes icon-color-tertiary">
                    {% render 'icon-flecha-abajo' %}
                  </div>
                </button>
                <div id="phpi-items-variantes" class="variantes-producto">
                  <div class="variante-producto-item">
                    <p>Personal</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                  <div class="variante-producto-item">
                    <p>Super Pers.</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                  <div class="variante-producto-item">
                    <p>Mediana</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                  <div class="variante-producto-item">
                    <p>Familiar</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                </div>
              </div>
              <button id="phpi-btn-personalizar" class="ph-btn-general   phpi-btn-personalizar">
                <p class="color-letras-secondary">PERSONALIZAR</p>
              </button>
            </div>
          </div>
          <div class="producto-item">
            <div class="producto-item-imagen">
              <img src="{{ 'imagen-pizza-1.png' | asset_url }}" alt="Pizza 1" width="100%" height="100%">
            </div>
            <div
              tipo-producto="simple"
              class="producto-item-detalle"
            >
              <div class="producto-item-info">
                <h3>CHESSY LOVERS</h3>
                <p>
                  Salsa de tomate, queso mozarella, Pepperoni, Jamón, carnes mixtas (res y cerdo, salchicha italiana y
                  tocino.
                </p>
              </div>
              <h3 class="color-letras-primary">12.56 BS</h3>
              <div
                id="phpi-general-variantes"
                tipo-producto="simple"
                class="seleccion-variante-producto-general"
              >
                <p>Tamaño</p>
                <button id="phpi-view-variantes" class="container-info-variante">
                  <p id="phpi-variante-seleccionado">Personal</p>
                  <div class="icono-dropdown-variantes icon-color-tertiary">
                    {% render 'icon-flecha-abajo' %}
                  </div>
                </button>
                <div id="phpi-items-variantes" class="variantes-producto">
                  <div class="variante-producto-item">
                    <p>Personal</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                  <div class="variante-producto-item">
                    <p>Super Pers.</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                  <div class="variante-producto-item">
                    <p>Mediana</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                  <div class="variante-producto-item">
                    <p>Familiar</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                </div>
              </div>
              <button id="phpi-btn-personalizar" class="ph-btn-general   phpi-btn-personalizar">
                <p class="color-letras-secondary">PERSONALIZAR</p>
              </button>
            </div>
          </div>
        </div>
        <div class="phpi-sector2-mobile" class="phpi-producto-especial">
          <div class="producto-item">
            <div class="producto-item-imagen">
              <img src="{{ 'imagen-pizza-1.png' | asset_url }}" alt="Pizza 1" width="100%" height="100%">
            </div>
            <div
              tipo-producto="simple"
              class="producto-item-detalle"
            >
              <div class="producto-item-info">
                <h3>CHESSY LOVERS</h3>
                <p>
                  Salsa de tomate, queso mozarella, Pepperoni, Jamón, carnes mixtas (res y cerdo, salchicha italiana y
                  tocino.
                </p>
              </div>
              <h3 class="color-letras-primary">12.56 BS</h3>
              <div
                id="phpi-general-variantes"
                tipo-producto="simple"
                class="seleccion-variante-producto-general"
              >
                <p>Tamaño</p>
                <button id="phpi-view-variantes" class="container-info-variante">
                  <p id="phpi-variante-seleccionado">Personal</p>
                  <div class="icono-dropdown-variantes icon-color-tertiary">
                    {% render 'icon-flecha-abajo' %}
                  </div>
                </button>
                <div id="phpi-items-variantes" class="variantes-producto">
                  <div class="variante-producto-item">
                    <p>Personal</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                  <div class="variante-producto-item">
                    <p>Super Pers.</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                  <div class="variante-producto-item">
                    <p>Mediana</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                  <div class="variante-producto-item">
                    <p>Familiar</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                </div>
              </div>
              <button id="phpi-btn-personalizar" class="ph-btn-general   phpi-btn-personalizar">
                <p class="color-letras-secondary">PERSONALIZAR</p>
              </button>
            </div>
          </div>
        </div>
        <div id="phpi-sector3-mobile" class="container-productos-general">
          <div class="producto-item">
            <div class="producto-item-imagen">
              <img src="{{ 'imagen-pizza-1.png' | asset_url }}" alt="Pizza 1" width="100%" height="100%">
            </div>
            <div
              tipo-producto="simple"
              class="producto-item-detalle"
            >
              <div class="producto-item-info">
                <h3>CHESSY LOVERS</h3>
                <p>
                  Salsa de tomate, queso mozarella, Pepperoni, Jamón, carnes mixtas (res y cerdo, salchicha italiana y
                  tocino.
                </p>
              </div>
              <h3 class="color-letras-primary">12.56 BS</h3>
              <div
                id="phpi-general-variantes"
                tipo-producto="simple"
                class="seleccion-variante-producto-general"
              >
                <p>Tamaño</p>
                <button id="phpi-view-variantes" class="container-info-variante">
                  <p id="phpi-variante-seleccionado">Personal</p>
                  <div class="icono-dropdown-variantes icon-color-tertiary">
                    {% render 'icon-flecha-abajo' %}
                  </div>
                </button>
                <div id="phpi-items-variantes" class="variantes-producto">
                  <div class="variante-producto-item">
                    <p>Personal</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                  <div class="variante-producto-item">
                    <p>Super Pers.</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                  <div class="variante-producto-item">
                    <p>Mediana</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                  <div class="variante-producto-item">
                    <p>Familiar</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                </div>
              </div>
              <button id="phpi-btn-personalizar" class="ph-btn-general   phpi-btn-personalizar">
                <p class="color-letras-secondary">PERSONALIZAR</p>
              </button>
            </div>
          </div>
          <div class="producto-item">
            <div class="producto-item-imagen">
              <img src="{{ 'imagen-pizza-1.png' | asset_url }}" alt="Pizza 1" width="100%" height="100%">
            </div>
            <div
              tipo-producto="simple"
              class="producto-item-detalle"
            >
              <div class="producto-item-info">
                <h3>CHESSY LOVERS</h3>
                <p>
                  Salsa de tomate, queso mozarella, Pepperoni, Jamón, carnes mixtas (res y cerdo, salchicha italiana y
                  tocino.
                </p>
              </div>
              <h3 class="color-letras-primary">12.56 BS</h3>
              <div
                id="phpi-general-variantes"
                tipo-producto="simple"
                class="seleccion-variante-producto-general"
              >
                <p>Tamaño</p>
                <button id="phpi-view-variantes" class="container-info-variante">
                  <p id="phpi-variante-seleccionado">Personal</p>
                  <div class="icono-dropdown-variantes icon-color-tertiary">
                    {% render 'icon-flecha-abajo' %}
                  </div>
                </button>
                <div id="phpi-items-variantes" class="variantes-producto">
                  <div class="variante-producto-item">
                    <p>Personal</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                  <div class="variante-producto-item">
                    <p>Super Pers.</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                  <div class="variante-producto-item">
                    <p>Mediana</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                  <div class="variante-producto-item">
                    <p>Familiar</p>
                    <p class="color-letras-primary">12.56 BS</p>
                  </div>
                </div>
              </div>
              <button id="phpi-btn-personalizar" class="ph-btn-general   phpi-btn-personalizar">
                <p class="color-letras-secondary">PERSONALIZAR</p>
              </button>
            </div>
          </div>
        </div>
      </div>
      <!-- APARTADO MOBIL -->
      <div class="container-productos-general phpi-control-desktop">
        <div class="producto-item">
          <div class="producto-item-imagen">
            <img src="{{ 'imagen-pizza-1.png' | asset_url }}" alt="Pizza 1" width="100%" height="100%">
          </div>
          <div
            tipo-producto="simple"
            class="producto-item-detalle"
          >
            <div class="producto-item-info">
              <h3>CHESSY LOVERS</h3>
              <p>
                Salsa de tomate, queso mozarella, Pepperoni, Jamón, carnes mixtas (res y cerdo, salchicha italiana y
                tocino.
              </p>
            </div>
            <h3 class="color-letras-primary">12.56 BS</h3>
            <div
              id="phpi-general-variantes"
              tipo-producto="simple"
              class="seleccion-variante-producto-general"
            >
              <p>Tamaño</p>
              <button id="phpi-view-variantes" class="container-info-variante">
                <p id="phpi-variante-seleccionado">Personal</p>
                <div class="icono-dropdown-variantes icon-color-tertiary">
                  {% render 'icon-flecha-abajo' %}
                </div>
              </button>
              <div id="phpi-items-variantes" class="variantes-producto">
                <div class="variante-producto-item">
                  <p>Personal</p>
                  <p class="color-letras-primary">12.56 BS</p>
                </div>
                <div class="variante-producto-item">
                  <p>Super Pers.</p>
                  <p class="color-letras-primary">12.56 BS</p>
                </div>
                <div class="variante-producto-item">
                  <p>Mediana</p>
                  <p class="color-letras-primary">12.56 BS</p>
                </div>
                <div class="variante-producto-item">
                  <p>Familiar</p>
                  <p class="color-letras-primary">12.56 BS</p>
                </div>
              </div>
            </div>
            <button id="phpi-btn-personalizar" class="ph-btn-general   phpi-btn-personalizar">
              <p class="color-letras-secondary">PERSONALIZAR</p>
            </button>
          </div>
        </div>
        <div class="producto-item">
          <div class="producto-item-imagen">
            <img src="{{ 'imagen-pizza-1.png' | asset_url }}" alt="Pizza 1" width="100%" height="100%">
          </div>
          <div
            tipo-producto="simple"
            class="producto-item-detalle"
          >
            <div class="producto-item-info">
              <h3>CHESSY LOVERS</h3>
              <p>
                Salsa de tomate, queso mozarella, Pepperoni, Jamón, carnes mixtas (res y cerdo, salchicha italiana y
                tocino.
              </p>
            </div>
            <h3 class="color-letras-primary">12.56 BS</h3>
            <div
              id="phpi-general-variantes"
              tipo-producto="simple"
              class="seleccion-variante-producto-general"
            >
              <p>Tamaño</p>
              <button id="phpi-view-variantes" class="container-info-variante">
                <p id="phpi-variante-seleccionado">Personal</p>
                <div class="icono-dropdown-variantes icon-color-tertiary">
                  {% render 'icon-flecha-abajo' %}
                </div>
              </button>
              <div id="phpi-items-variantes" class="variantes-producto">
                <div class="variante-producto-item">
                  <p>Personal</p>
                  <p class="color-letras-primary">12.56 BS</p>
                </div>
                <div class="variante-producto-item">
                  <p>Super Pers.</p>
                  <p class="color-letras-primary">12.56 BS</p>
                </div>
                <div class="variante-producto-item">
                  <p>Mediana</p>
                  <p class="color-letras-primary">12.56 BS</p>
                </div>
                <div class="variante-producto-item">
                  <p>Familiar</p>
                  <p class="color-letras-primary">12.56 BS</p>
                </div>
              </div>
            </div>
            <button id="phpi-btn-personalizar" class="ph-btn-general   phpi-btn-personalizar">
              <p class="color-letras-secondary">PERSONALIZAR</p>
            </button>
          </div>
        </div>
        <div class="producto-item">
          <div class="producto-item-imagen">
            <img src="{{ 'imagen-pizza-1.png' | asset_url }}" alt="Pizza 1" width="100%" height="100%">
          </div>
          <div
            tipo-producto="simple"
            class="producto-item-detalle"
          >
            <div class="producto-item-info">
              <h3>CHESSY LOVERS</h3>
              <p>
                Salsa de tomate, queso mozarella, Pepperoni, Jamón, carnes mixtas (res y cerdo, salchicha italiana y
                tocino.
              </p>
            </div>
            <h3 class="color-letras-primary">12.56 BS</h3>
            <div
              id="phpi-general-variantes"
              tipo-producto="simple"
              class="seleccion-variante-producto-general"
            >
              <p>Tamaño</p>
              <button id="phpi-view-variantes" class="container-info-variante">
                <p id="phpi-variante-seleccionado">Personal</p>
                <div class="icono-dropdown-variantes icon-color-tertiary">
                  {% render 'icon-flecha-abajo' %}
                </div>
              </button>
              <div id="phpi-items-variantes" class="variantes-producto">
                <div class="variante-producto-item">
                  <p>Personal</p>
                  <p class="color-letras-primary">12.56 BS</p>
                </div>
                <div class="variante-producto-item">
                  <p>Super Pers.</p>
                  <p class="color-letras-primary">12.56 BS</p>
                </div>
                <div class="variante-producto-item">
                  <p>Mediana</p>
                  <p class="color-letras-primary">12.56 BS</p>
                </div>
                <div class="variante-producto-item">
                  <p>Familiar</p>
                  <p class="color-letras-primary">12.56 BS</p>
                </div>
              </div>
            </div>
            <button id="phpi-btn-personalizar" class="ph-btn-general   phpi-btn-personalizar">
              <p class="color-letras-secondary">PERSONALIZAR</p>
            </button>
          </div>
        </div>
        <div class="producto-item">
          <div class="producto-item-imagen">
            <img src="{{ 'imagen-pizza-1.png' | asset_url }}" alt="Pizza 1" width="100%" height="100%">
          </div>
          <div
            tipo-producto="simple"
            class="producto-item-detalle"
          >
            <div class="producto-item-info">
              <h3>CHESSY LOVERS</h3>
              <p>
                Salsa de tomate, queso mozarella, Pepperoni, Jamón, carnes mixtas (res y cerdo, salchicha italiana y
                tocino.
              </p>
            </div>
            <h3 class="color-letras-primary">12.56 BS</h3>
            <div
              id="phpi-general-variantes"
              tipo-producto="simple"
              class="seleccion-variante-producto-general"
            >
              <p>Tamaño</p>
              <button id="phpi-view-variantes" class="container-info-variante">
                <p id="phpi-variante-seleccionado">Personal</p>
                <div class="icono-dropdown-variantes icon-color-tertiary">
                  {% render 'icon-flecha-abajo' %}
                </div>
              </button>
              <div id="phpi-items-variantes" class="variantes-producto">
                <div class="variante-producto-item">
                  <p>Personal</p>
                  <p class="color-letras-primary">12.56 BS</p>
                </div>
                <div class="variante-producto-item">
                  <p>Super Pers.</p>
                  <p class="color-letras-primary">12.56 BS</p>
                </div>
                <div class="variante-producto-item">
                  <p>Mediana</p>
                  <p class="color-letras-primary">12.56 BS</p>
                </div>
                <div class="variante-producto-item">
                  <p>Familiar</p>
                  <p class="color-letras-primary">12.56 BS</p>
                </div>
              </div>
            </div>
            <button id="phpi-btn-personalizar" class="ph-btn-general   phpi-btn-personalizar">
              <p class="color-letras-secondary">PERSONALIZAR</p>
            </button>
          </div>
        </div>
      </div>
    </section>
  </div>
</productos-index>

{% style %}
  .phpi-general-mobile {
    width: 100%;
    height: max-content;
    display: flex;
    flex-direction: column;
    gap: var(--espaciado-xl);
  }

  .phpi-control-desktop {
    display: none;
  }

  .container-productos-general {
    width: 100%;
    height: max-content;
  }

  /* PRODUCTO ESPECIAL */
  .phpi-producto-especial {
    width: 100%;
    height: max-content;
  }

  @media (min-width: 768px) {
    .phpi-general-mobile {
      display: none;
    }

    .phpi-control-desktop {
      display: flex;
    }
  }
{% endstyle %}

<script>
  class ProductosIndex extends HTMLElement {
    constructor() {
      super();
    }

    connectedCallback() {
      // REFERENCIAS ELEMENTOS
      this.contenedorVarianteSeleccionado = this.querySelectorAll('#phpi-view-variantes');
      this.contenedorVariantes = this.querySelectorAll('#phpi-items-variantes');
      this.varianteElemento = this.querySelectorAll('.variante-producto-item');
      this.btnsPersonalizar = this.querySelectorAll('#phpi-btn-personalizar');

      // EVENTOS INICIALIZAR

      this.contenedorVarianteSeleccionado.forEach((elementoBase) => {
        elementoBase.addEventListener('click', this.mostrarYOcultarContenedorVariantes.bind(this, elementoBase));
      });
      this.btnsPersonalizar.forEach((elementoBtnPersonalizar) => {
        elementoBtnPersonalizar.addEventListener(
          'click',
          this.redireccionPersonalizar.bind(this, elementoBtnPersonalizar)
        );
      });
      this.varianteElemento.forEach((elementoBase) => {
        elementoBase.addEventListener('click', this.procesoVarianteSeleccionada.bind(this, elementoBase));
      });
      document.addEventListener('click', this.clicksEspeciales.bind(this));

      // INICIALIZAR ELEMENTOS Y PROCESOS CLAVES
      this.contenedorVariantes.forEach((elementoBase) => {
        elementoBase.classList.add('elemento-oculto');
      });
    }

    mostrarYOcultarContenedorVariantes(elementoBase) {
      // Busco al elemento Padre
      const elementoPadre = elementoBase.closest('#phpi-general-variantes');
      // Busco a su hermano
      const hermano = elementoPadre.querySelector('#phpi-items-variantes');

      const estaVisible = hermano.classList.contains('elemento-visible');

      if(estaVisible) {
        hermano.classList.remove('elemento-visible');
        hermano.classList.add('elemento-oculto');
      } else {
        hermano.classList.remove('elemento-oculto');
        hermano.classList.add('elemento-visible');
      }

      // Oculto a los otros elementos
      this.contenedorVariantes.forEach((elemento) => {
        if (elemento !== hermano) {
          elemento.classList.remove('elemento-visible');
          elemento.classList.add('elemento-oculto');
          {% comment %} elemento.style.display = "none"; {% endcomment %}
        }
      });
    }

    clicksEspeciales(event){
      // Si el click es en algun elemento con id="phpi-view-variantes" no hace nada y se sale
      let clickEnContenedorVariante = false;
      this.contenedorVarianteSeleccionado.forEach((elementoBase) => {
        if (elementoBase.contains(event.target)) {
          clickEnContenedorVariante = true;
        }
      });

      if (clickEnContenedorVariante) {
        return;
      }

      // Si el elemento clickeado no es en el contenedor id="phpi-items-variantes" tons cierra a todos
      this.contenedorVariantes.forEach((elementoBase) => {
        if (!elementoBase.contains(event.target)) {
          {% comment %} elementoBase.style.display = "none"; // Oculto {% endcomment %}
           elementoBase.classList.remove('elemento-visible');
           elementoBase.classList.add('elemento-oculto');
        }
      });
    }

    redireccionPersonalizar(elementoBtn){
      const padreElemento = elementoBtn.closest('.producto-es-item-detalle') || elementoBtn.closest('.producto-item-detalle');

      const dataPadre = padreElemento.getAttribute('tipo-producto');

      if(dataPadre == null){
        window.location.href = "/";
      }

      localStorage.setItem('phpp-tipo-producto', dataPadre);
      window.location.href = "/pages/producto";
    }


    procesoVarianteSeleccionada(elementoBase){
      // Busco dentro del elemento al la primer etiqueta <p> y obtengo su valor ya que tenog 3 etiqueta p
      const primerP = elementoBase.querySelectorAll('p')[0];
      // Busco al elemento Padre General con id="phpi-general-variantes"
      const padreGeneral = elementoBase.closest('#phpi-general-variantes');
      // Busco al hijo de Padre con id="phpi-view-variantes"
      const hijo = padreGeneral.querySelector('#phpi-view-variantes');
      // El hijo tiene otro hijo que es una etiqueta p con id="phpi-variante-seleccionado"
      const hijoP = hijo.querySelector('#phpi-variante-seleccionado');
      hijoP.innerHTML = primerP.innerHTML; // Cambiamos el valor de la etiqueta p
      // Busco al elemento Padre id="phpi-items-variantes"
      // O tambien cierro a todos con ese id
      this.contenedorVariantes.forEach((elementoBase) => {
        if (elementoBase !== padreGeneral) {
          {% comment %} elementoBase.style.display = "none"; {% endcomment %}
          elementoBase.classList.remove('elemento-visible');
          elementoBase.classList.add('elemento-oculto');
        }
      });
    }
  }

  customElements.define('productos-index', ProductosIndex);
</script>

{% schema %}
{
  "name": "Productos Principales",
  "tag": "section",
  "class": "productos-index",
  "settings": [],
  "blocks": []
}
{% endschema %}

{% comment %} asdsa {% endcomment %}
